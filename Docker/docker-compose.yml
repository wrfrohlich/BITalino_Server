version: '3'

volumes:
    data:
 
networks:
    my-network:
        driver: bridge
    
services:
    web:
        image: grafana/grafana:7.0.0
        volumes:
            - ./web/datasources/datasource.yaml:/etc/grafana/provisioning/datasources/datasource.yaml
            - ./web/dashboards:/etc/grafana/provisioning/dashboards
        ports:
            - 18000:3000
        networks:
            - my-network
    
    database:
        image: postgres:9.6
        environment:
            POSTGRES_HOST_AUTH_METHOD: "trust"
        volumes:
            - ./database:/database
            - ./database/init.sql:/docker-entrypoint-initdb.d/init.sql
        ports:
            - 18001:5432
        networks:
            - my-network
 
    processing:
        image: python:3.8.3
        volumes:
            - ./processing:/usr/src/processing
        ports:
            - 18101:18101/udp
            - 18102:18102/udp
            - 18103:18103/udp
            - 18106:18106/udp
        working_dir: /usr/src/processing
        command: bash ./start_processing.sh
        networks:
            - my-network